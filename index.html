<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏©‡∏µ‡∏™‡∏£‡∏£‡∏û‡∏™‡∏≤‡∏°‡∏¥‡∏ï</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html,body { height:100%; }

  body {
    font-family: "Segoe UI", "Prompt", "Sarabun", sans-serif;
    background-color: #f7f9fb;
    position: relative;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 32px;
    color: #0f172a;
  }

  body::before {
    content: "";
    position: fixed;
    inset: 0;
    background-image: url("https://upload.wikimedia.org/wikipedia/commons/3/37/Logo_of_the_Excise_Department.svg");
    background-repeat: repeat;
    background-size: 180px;
    background-position: 80px 80px;
    opacity: 0.04;
    z-index: 0;
    filter: grayscale(100%) blur(1px);
  }

  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(255,255,255,0.94);
    backdrop-filter: blur(3px);
    z-index: 1;
  }

  .card {
    position: relative;
    z-index: 2;
    width: 580px;
    max-width: 95%;
    background: rgba(255,255,255,0.99);
    border-radius: 16px;
    padding: 34px 34px;
    box-shadow: 0 12px 40px rgba(2,6,23,0.06);
    border: 1px solid rgba(15,23,42,0.04);
  }

  @media (max-width: 768px) {
    .card {
      width: 100%;
      max-width: 100%;
      padding: 20px 16px;
      border-radius: 12px;
      margin: 16px 0;
    }
  }

  .header {
    text-align: center;
    margin-bottom: 16px;
  }

  .main-logo {
    width: 110px;
    display: inline-block;
    margin-bottom: 10px;
    opacity: 0.98;
  }

  @media (max-width: 768px) {
    .main-logo {
      width: 80px;
      margin-bottom: 8px;
    }
  }

  .title {
    font-size: 1.45rem;
    font-weight: 700;
    color: #0f172a;
    margin-bottom: 4px;
  }

  @media (max-width: 768px) {
    .title {
      font-size: 1.1rem;
      line-height: 1.4;
    }
  }

  .subtitle {
    font-size: 13px;
    color: #64748b;
  }

  @media (max-width: 768px) {
    .subtitle {
      font-size: 11px;
    }
  }

  /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó */
  .type-selector {
    display: flex;
    gap: 12px;
    margin: 20px 0;
    justify-content: center;
    flex-wrap: wrap;
  }

  @media (max-width: 768px) {
    .type-selector {
      gap: 8px;
      margin: 16px 0;
    }
  }

  .type-option {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 18px;
    border: 2px solid #d1d5db;
    border-radius: 10px;
    cursor: pointer;
    background: #fff;
    transition: all 0.2s;
  }

  @media (max-width: 768px) {
    .type-option {
      flex: 1;
      min-width: calc(33.333% - 6px);
      padding: 10px 12px;
      justify-content: center;
      font-size: 14px;
    }
  }

  .type-option:hover {
    border-color: #2563eb;
    background: #eff6ff;
  }

  .type-option input[type="radio"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }

  .type-option.selected {
    border-color: #2563eb;
    background: #dbeafe;
    font-weight: 600;
  }

  .type-option.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background: #f1f5f9;
  }

  .type-option.disabled:hover {
    border-color: #d1d5db;
    background: #f1f5f9;
  }

  label {
    display:block;
    font-weight:600;
    color:#334155;
    margin-top:16px;
    margin-bottom:8px;
    font-size:14px;
  }

  select, input[type="number"] {
    width:100%;
    padding:10px 12px;
    border-radius:10px;
    border:1px solid #d1d5db;
    background:#fbfdff;
    font-size:15px;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.03);
  }
  
  select:focus, input:focus {
    outline:none;
    border-color:#2563eb;
    box-shadow:0 0 0 3px rgba(37,99,235,0.08);
    background:#ffffff;
  }

  .history-row {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-top:6px;
  }

  .history-item {
    display:flex;
    align-items:center;
    gap:8px;
    white-space:nowrap;
    font-weight:500;
    color:#334155;
    font-size:14px;
  }

  .history-item input[type="radio"] {
    width:16px;
    height:16px;
  }

  .buttons {
    margin-top:20px;
    display:flex;
    gap:10px;
    flex-direction:column;
  }

  .btn {
    width:100%;
    padding:12px;
    border-radius:10px;
    border:none;
    font-weight:700;
    cursor:pointer;
  }

  .btn-calc {
    background: linear-gradient(90deg,#2563eb,#1e40af);
    color:#fff;
  }
  .btn-calc:hover { transform: translateY(-2px); box-shadow:0 10px 30px rgba(30,64,175,0.12); }

  .btn-reset {
    background:#ef4444;
    color:#fff;
  }
  .btn-reset:hover { background:#dc2626; }

  .btn-add {
    background: #10b981;
    color: #fff;
    margin-top: 12px;
  }
  .btn-add:hover { background: #059669; }

  .btn-delete {
    background: #ef4444;
    color: #fff;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 13px;
    border: none;
    cursor: pointer;
    margin-top: 10px;
  }
  .btn-delete:hover { background: #dc2626; }

  .result {
    margin-top:18px;
    padding:16px;
    border-radius:10px;
    background:#f8fafc;
    border:1px solid #e6eef9;
    color:#0f172a;
    line-height:1.7;
    display:none;
  }

  .result.show { display:block; animation:fadeIn .45s ease; }

  @keyframes fadeIn {
    from { opacity:0; transform: translateY(6px); }
    to { opacity:1; transform: translateY(0); }
  }

  .footer {
    margin-top:14px;
    font-size:13px;
    color:#94a3b8;
    text-align:center;
  }

  .cigarette-item {
    padding: 14px;
    margin-top: 12px;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    background: #fafbfc;
    position: relative;
  }

  .cigarette-item h4 {
    color: #1e40af;
    margin-bottom: 10px;
    font-size: 15px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 12px;
    font-size: 14px;
    overflow-x: auto;
    display: block;
  }

  @media (max-width: 768px) {
    table {
      font-size: 12px;
    }
  }

  table th {
    background: #f1f5f9;
    padding: 10px;
    text-align: left;
    border: 1px solid #e2e8f0;
    font-weight: 600;
  }

  @media (max-width: 768px) {
    table th {
      padding: 8px 6px;
      font-size: 11px;
    }
  }

  table td {
    padding: 10px;
    border: 1px solid #e2e8f0;
  }

  @media (max-width: 768px) {
    table td {
      padding: 8px 6px;
      font-size: 11px;
    }
  }

  table tfoot td {
    background: #fef3c7;
    font-weight: 700;
  }

  .input-section {
    display: none;
  }

  .input-section.active {
    display: block;
  }

  @media (max-width:520px) {
    body {
      padding: 16px 8px;
    }
    
    .card {
      padding: 16px 12px;
    }
    
    .type-option {
      min-width: 100%;
      padding: 12px 16px;
    }
    
    .history-row { 
      flex-direction:column; 
      align-items:flex-start; 
      gap:8px; 
    }
    
    .btn {
      padding: 14px;
      font-size: 15px;
    }
    
    select, input[type="number"] {
      padding: 12px;
      font-size: 16px;
    }
    
    .result {
      font-size: 14px;
      padding: 14px;
    }
    
    .cigarette-item {
      padding: 12px;
    }
    
    table {
      font-size: 10px;
    }
    
    table th, table td {
      padding: 6px 4px;
    }
  }
</style>
</head>
<body>
  <div class="overlay" aria-hidden="true"></div>

  <main class="card" role="main">
    <div class="header">
      <img class="main-logo" src="https://upload.wikimedia.org/wikipedia/commons/3/37/Logo_of_the_Excise_Department.svg" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏Å‡∏£‡∏°‡∏™‡∏£‡∏£‡∏û‡∏™‡∏≤‡∏°‡∏¥‡∏ï">
      <div class="title">üßæ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏©‡∏µ</div>
      <div class="subtitle">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏£‡∏û‡∏™‡∏≤‡∏°‡∏¥‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏Ç‡∏•‡∏≤ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏™‡∏∞‡πÄ‡∏î‡∏≤</div>
    </div>

    <!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó -->
    <div class="type-selector">
      <label class="type-option selected">
        <input type="radio" name="excise-type" value="oil" checked onchange="switchType('oil')">
        <span>‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</span>
      </label>
      <label class="type-option">
        <input type="radio" name="excise-type" value="cigarette" onchange="switchType('cigarette')">
        <span>‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà</span>
      </label>
      <label class="type-option">
        <input type="radio" name="excise-type" value="card" onchange="switchType('card')">
        <span>‡πÑ‡∏û‡πà</span>
      </label>
    </div>

    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô -->
    <div id="oil-section" class="input-section active">
      <label for="charge">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤:</label>
      <select id="charge">
        <option value="‡∏Ç‡∏≤‡∏¢">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡∏≤‡∏¢</option>
        <option value="‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á</option>
      </select>

      <label for="fuel">‡∏ä‡∏ô‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á:</label>
      <select id="fuel">
        <option value="‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô">‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô</option>
        <option value="‡∏î‡∏µ‡πÄ‡∏ã‡∏•">‡∏î‡∏µ‡πÄ‡∏ã‡∏•</option>
      </select>

      <label for="liters">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏¥‡∏ï‡∏£:</label>
      <input id="liters" type="number" step="any" min="0" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏¥‡∏ï‡∏£">

      <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î:</label>
      <div class="history-row">
        <label class="history-item">
          <input type="radio" name="history" value="no" checked> ‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î
        </label>
        <label class="history-item">
          <input type="radio" name="history" value="yes"> ‡πÄ‡∏Ñ‡∏¢‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î
        </label>
      </div>
    </div>

    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà -->
    <div id="cigarette-section" class="input-section">
      <label for="cig-charge">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤:</label>
      <select id="cig-charge">
        <option value="‡∏Ç‡∏≤‡∏¢">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡∏≤‡∏¢</option>
        <option value="‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á</option>
      </select>

      <div id="cigarette-items">
        <div class="cigarette-item" data-item-id="1">
          <h4>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 1</h4>
          <label>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡∏£‡∏£‡∏à‡∏∏ (‡∏°‡∏ß‡∏ô/‡∏ã‡∏≠‡∏á):</label>
          <input type="number" class="cig-size" step="1" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 20">
          
          <label style="margin-top:12px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏ã‡∏≠‡∏á):</label>
          <input type="number" class="cig-qty" step="1" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 10">
        </div>
      </div>

      <button class="btn btn-add" onclick="addCigaretteItem()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
    </div>

    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÑ‡∏û‡πà -->
    <div id="card-section" class="input-section">
      <label for="card-charge">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤:</label>
      <select id="card-charge">
        <option value="‡∏Ç‡∏≤‡∏¢">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡∏≤‡∏¢</option>
        <option value="‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á">‡∏Ç‡πâ‡∏≠‡∏´‡∏≤‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á</option>
      </select>

      <label for="card-size">‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡∏£‡∏£‡∏à‡∏∏ (‡πÉ‡∏ö/‡∏™‡∏≥‡∏£‡∏±‡∏ö):</label>
      <input id="card-size" type="number" step="1" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 52">

      <label for="card-qty">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏™‡∏≥‡∏£‡∏±‡∏ö):</label>
      <input id="card-qty" type="number" step="1" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 10">
    </div>

    <div class="buttons">
      <button class="btn btn-calc" onclick="calculate()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
      <button class="btn btn-reset" onclick="resetForm()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </div>

    <div id="output" class="result"></div>

    <div class="footer">¬© ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏£‡∏û‡∏™‡∏≤‡∏°‡∏¥‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏á‡∏Ç‡∏•‡∏≤ ‡∏™‡∏≤‡∏Ç‡∏≤‡∏™‡∏∞‡πÄ‡∏î‡∏≤</div>
  </main>

<script>
  let cigaretteCount = 1;
  let nextItemId = 2;

  function switchType(type) {
    document.querySelectorAll('.input-section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.type-option').forEach(opt => opt.classList.remove('selected'));
    
    if (type === 'oil') {
      document.getElementById('oil-section').classList.add('active');
      document.querySelectorAll('.type-option')[0].classList.add('selected');
    } else if (type === 'cigarette') {
      document.getElementById('cigarette-section').classList.add('active');
      document.querySelectorAll('.type-option')[1].classList.add('selected');
    } else if (type === 'card') {
      document.getElementById('card-section').classList.add('active');
      document.querySelectorAll('.type-option')[2].classList.add('selected');
    }
    
    document.getElementById('output').classList.remove('show');
    document.getElementById('output').innerHTML = '';
  }

  function addCigaretteItem() {
    cigaretteCount++;
    const container = document.getElementById('cigarette-items');
    const newItem = document.createElement('div');
    newItem.className = 'cigarette-item';
    newItem.setAttribute('data-item-id', nextItemId);
    newItem.innerHTML = `
      <h4>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà ${cigaretteCount}</h4>
      <label>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡∏£‡∏£‡∏à‡∏∏ (‡∏°‡∏ß‡∏ô/‡∏ã‡∏≠‡∏á):</label>
      <input type="number" class="cig-size" step="1" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 20">
      
      <label style="margin-top:12px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏ã‡∏≠‡∏á):</label>
      <input type="number" class="cig-qty" step="1" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 10">
      
      <button class="btn-delete" onclick="deleteCigaretteItem(${nextItemId})">üóëÔ∏è ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</button>
    `;
    container.appendChild(newItem);
    nextItemId++;
  }

  function deleteCigaretteItem(itemId) {
    const container = document.getElementById('cigarette-items');
    const item = container.querySelector(`[data-item-id="${itemId}"]`);
    
    if (item) {
      item.remove();
      cigaretteCount--;
      renumberCigaretteItems();
    }
  }

  function renumberCigaretteItems() {
    const items = document.querySelectorAll('.cigarette-item');
    items.forEach((item, index) => {
      const h4 = item.querySelector('h4');
      h4.textContent = `‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà ${index + 1}`;
    });
  }

  function getHistory() {
    const r = document.querySelector('input[name="history"]:checked');
    return r ? r.value : 'no';
  }

  function calculate() {
    const type = document.querySelector('input[name="excise-type"]:checked').value;
    
    if (type === 'oil') {
      calculateOil();
    } else if (type === 'cigarette') {
      calculateCigarette();
    } else if (type === 'card') {
      calculateCard();
    }
  }

  function calculateOil() {
    const charge = document.getElementById('charge').value;
    const fuel = document.getElementById('fuel').value;
    const litersRaw = document.getElementById('liters').value;
    const liters = parseFloat(litersRaw);
    const history = getHistory();
    const output = document.getElementById('output');

    if (isNaN(liters) || liters <= 0) {
      output.innerHTML = `<span style="color:#b91c1c;font-weight:700;">‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏¥‡∏ï‡∏£‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span>`;
      output.classList.add('show');
      return;
    }

    const rate = (fuel === '‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô') ? 7.5 : 7.44;

    let fineMultiplier;
    if (history === 'yes') {
      fineMultiplier = (charge === '‡∏Ç‡∏≤‡∏¢') ? 15 : 10;
    } else {
      fineMultiplier = (charge === '‡∏Ç‡∏≤‡∏¢') ? 7 : 5;
    }

    const fineRaw = liters * fineMultiplier * rate;
    const fine = Math.floor(fineRaw * 100) / 100;
    const tax = Math.floor(liters * rate);
    const rawAdmin = liters * rate * 0.1;
    const rounded3 = Math.floor(rawAdmin * 1000 + 0.5) / 1000;
    const adminTax = Math.round(rounded3 * 100) / 100;
    const total = fine + tax + adminTax;

    output.innerHTML = `
      <div><strong>‡∏Ç‡πâ‡∏≠‡∏´‡∏≤:</strong> ${charge}</div>
      <div><strong>‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á:</strong> ${fuel}</div>
      <div><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏¥‡∏ï‡∏£:</strong> ${liters.toLocaleString()} ‡∏•‡∏¥‡∏ï‡∏£</div>
      <hr style="border:none;height:1px;background:#e6eef9;margin:10px 0;">
      <div><strong>‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö:</strong> ${fine.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})} ‡∏ö‡∏≤‡∏ó</div>
      <div><strong>‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏µ:</strong> ${tax.toLocaleString()} ‡∏ö‡∏≤‡∏ó</div>
      <div><strong>‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏´‡∏≤‡∏î‡πÑ‡∏ó‡∏¢:</strong> ${adminTax.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})} ‡∏ö‡∏≤‡∏ó</div>
      <hr style="border:none;height:1px;background:#e6eef9;margin:10px 0;">
      <div style="font-weight:800;"><strong>‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô:</strong> ${total.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})} ‡∏ö‡∏≤‡∏ó</div>
    `;

    output.classList.add('show');
    output.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }

  function calculateCigarette() {
    const charge = document.getElementById('cig-charge').value;
    const items = document.querySelectorAll('.cigarette-item');
    const output = document.getElementById('output');

    const N = (charge === '‡∏Ç‡∏≤‡∏¢') ? 15 : 10;
    const itemsData = [];
    let hasError = false;

    items.forEach((item, index) => {
      const sizeInput = item.querySelector('.cig-size');
      const qtyInput = item.querySelector('.cig-qty');
      const size = parseFloat(sizeInput.value);
      const qty = parseFloat(qtyInput.value);

      if (isNaN(size) || size <= 0 || isNaN(qty) || qty <= 0) {
        hasError = true;
        return;
      }

      const taxPerPack = 3.14 * size;
      const totalTax = 3.14 * size * qty;
      const fine = 3.14 * size * qty * N;

      itemsData.push({
        no: index + 1,
        size: size,
        qty: qty,
        taxPerPack: taxPerPack,
        totalTax: totalTax,
        fine: fine
      });
    });

    if (hasError || itemsData.length === 0) {
      output.innerHTML = `<span style="color:#b91c1c;font-weight:700;">‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span>`;
      output.classList.add('show');
      return;
    }

    let sumTaxPerPack = 0;
    let sumTotalTax = 0;
    let sumFine = 0;

    let tableRows = '';
    itemsData.forEach(item => {
      sumTaxPerPack += item.taxPerPack;
      sumTotalTax += item.totalTax;
      sumFine += item.fine;

      tableRows += `
        <tr>
          <td>${item.no}</td>
          <td>${item.size}</td>
          <td>${item.qty}</td>
          <td>${item.taxPerPack.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
          <td>${item.totalTax.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
          <td>${item.fine.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
        </tr>
      `;
    });

    output.innerHTML = `
      <div><strong>‡∏Ç‡πâ‡∏≠‡∏´‡∏≤:</strong> ${charge}</div>
      <div><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà</div>
      <hr style="border:none;height:1px;background:#e6eef9;margin:10px 0;">
      <table>
        <thead>
          <tr>
            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
            <th>‡∏Ç‡∏ô‡∏≤‡∏î (‡∏°‡∏ß‡∏ô)</th>
            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏ã‡∏≠‡∏á)</th>
            <th>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏µ‡∏ï‡πà‡∏≠‡∏ã‡∏≠‡∏á</th>
            <th>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</th>
            <th>‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö</th>
          </tr>
        </thead>
        <tbody>
          ${tableRows}
        </tbody>
        <tfoot>
          <tr>
            <td colspan="3"><strong>‡∏£‡∏ß‡∏°</strong></td>
            <td><strong>${sumTaxPerPack.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</strong></td>
            <td><strong>${sumTotalTax.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</strong></td>
            <td><strong>${sumFine.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</strong></td>
          </tr>
        </tfoot>
      </table>
    `;

    output.classList.add('show');
    output.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }

  function calculateCard() {
    const charge = document.getElementById('card-charge').value;
    const sizeRaw = document.getElementById('card-size').value;
    const qtyRaw = document.getElementById('card-qty').value;
    const size = parseFloat(sizeRaw);
    const qty = parseFloat(qtyRaw);
    const output = document.getElementById('output');

    if (isNaN(size) || size <= 0 || isNaN(qty) || qty <= 0) {
      output.innerHTML = `<span style="color:#b91c1c;font-weight:700;">‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span>`;
      output.classList.add('show');
      return;
    }

    const N = (charge === '‡∏Ç‡∏≤‡∏¢') ? 15 : 10;
    const tax = size * qty * 0.3;
    const fine = size * qty * 0.3 * N;

    output.innerHTML = `
      <div><strong>‡∏Ç‡πâ‡∏≠‡∏´‡∏≤:</strong> ${charge}</div>
      <div><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ‡πÑ‡∏û‡πà</div>
      <div><strong>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡∏£‡∏£‡∏à‡∏∏:</strong> ${size.toLocaleString()} ‡πÉ‡∏ö/‡∏™‡∏≥‡∏£‡∏±‡∏ö</div>
      <div><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</strong> ${qty.toLocaleString()} ‡∏™‡∏≥‡∏£‡∏±‡∏ö</div>
      <hr style="border:none;height:1px;background:#e6eef9;margin:10px 0;">
      <div><strong>‡∏†‡∏≤‡∏©‡∏µ:</strong> ${tax.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})} ‡∏ö‡∏≤‡∏ó</div>
      <div><strong>‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö:</strong> ${fine.toLocaleString('th-TH', {minimumFractionDigits: 2, maximumFractionDigits: 2})} ‡∏ö‡∏≤‡∏ó</div>
    `;

    output.classList.add('show');
    output.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }

  function resetForm() {
    document.getElementById('liters').value = '';
    document.getElementById('charge').selectedIndex = 0;
    document.getElementById('fuel').selectedIndex = 0;
    document.getElementById('cig-charge').selectedIndex = 0;
    document.getElementById('card-charge').selectedIndex = 0;
    document.getElementById('card-size').value = '';
    document.getElementById('card-qty').value = '';
    document.querySelector('input[name="history"][value="no"]').checked = true;
    
    const container = document.getElementById('cigarette-items');
    container.innerHTML = `
      <div class="cigarette-item" data-item-id="1">
        <h4>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 1</h4>
        <label>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡∏£‡∏£‡∏à‡∏∏ (‡∏°‡∏ß‡∏ô/‡∏ã‡∏≠‡∏á):</label>
        <input type="number" class="cig-size" step="1" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 20">
        
        <label style="margin-top:12px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏ã‡∏≠‡∏á):</label>
        <input type="number" class="cig-qty" step="1" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 10">
      </div>
    `;
    cigaretteCount = 1;
    nextItemId = 2;
    
    const output = document.getElementById('output');
    output.innerHTML = '';
    output.classList.remove('show');
  }
</script>
</body>
</html>
